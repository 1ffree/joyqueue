
pipeline {
    agent any
    stages {

        stage('Test') {
            steps {
                echo 'Packaging....'
                sh 'mvn -Dmaven.test.skip=true clean package'
            }
        }
        stage('Integration Test') {
                    steps {
                        echo 'Integration Test....'
                        sh 'pwd && ls '
                        sh 'ls '
                        sh 'cd docker/bin && integrate_test.sh'
                    }
                }


    }
    post {
        failure {
          updateGitlabCommitStatus name: 'build', state: 'failed'
        }
        success {
          updateGitlabCommitStatus name: 'build', state: 'success'
        }
      }

}