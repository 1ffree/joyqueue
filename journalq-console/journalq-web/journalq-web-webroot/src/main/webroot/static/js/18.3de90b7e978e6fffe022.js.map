{"version":3,"sources":["webpack:///src/views/topic/partitionGroup.vue","webpack:///./src/views/topic/partitionGroup.vue?39dd","webpack:///./src/views/topic/partitionGroup.vue"],"names":["partitionGroup","name","components","GroupPosition","groupPosition","myTable","myDialog","groupDetail","groupScale","groupMerge","groupNew","mixins","crud","props","showHostChart","type","Boolean","default","showBrokerChart","data","urls","search","del","getBroker","addPartition","removePartition","getMonitor","getUrl","searchData","topic","id","this","$route","query","code","namespace","namespaceId","namespaceCode","keyword","tableData","rowData","colData","title","width","key","render","h","params","label","item","electType","formatter","leader","ip","btns","txt","method","groupDetailDialog","visible","showFooter","groupDetailDialogData","positionDialog","positionDialogData","groupScaleDialog","groupScaleDialogData","groupMergeDialog","groupMergeDialogData","addPartitionDialog","addPartitionDialogData","removePartitionDialog","removePartitionDialogData","groupNewDialog","groupNewDialogData","replicaGroups","partitions","newGroupData","computed","methods","getList","_this","showTablePin","pagination","page","size","apiRequest","post","urlOrigin","then","totalRecord","length","total","i","_this2","get","$set","goBrokerChart","_this3","url","indexOf","endsWith","Object","common","window","open","goHostChart","_this4","goDetail","groupNo","groupDetailConfirm","groupDetailCancel","goPosition","positionConfirm","positionCancel","groupScaleConfirm","groupScaleCancel","groupNewConfirm","groupNewCancel","groupMergeConfirm","groupMergeCancel","addPartitionConfirm","_this5","partitionsCount","addPartitionCancel","removePartitionConfirm","_this6","removePartitionCancel","_this7","topicUpdate","$emit","afterDel","mounted","topic_partitionGroup","_vm","_h","$createElement","_c","_self","staticClass","attrs","on","click","_v","staticStyle","margin-left","_t","_e","showPin","on-size-change","handleSizeChange","on-current-change","handleCurrentChange","on-view-detail","on-scale","on-merge","on-del","on-addPartition","on-removePartition","on-position","dialog","on-dialog-confirm","$event","on-dialog-cancel","placeholder","model","value","callback","$$v","expression","slot","on-partition-group-change","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/18.3de90b7e978e6fffe022.js","sourcesContent":["<template>\r\n  <div>\r\n    <div class=\"ml20 mt30\">\r\n      <d-button type=\"primary\" @click=\"groupNew\" class=\"left mr10\">\r\n        扩容\r\n        <icon name=\"plus-circle\" style=\"margin-left: 5px;\"/>\r\n      </d-button>\r\n      <slot name=\"extendBtns\"></slot>\r\n      <d-button type=\"primary\" v-if=\"showBrokerChart\" @click=\"goBrokerChart\" class=\"left mr10\">\r\n        Broker监控\r\n        <icon name=\"bar-chart\" style=\"margin-left: 5px;\"/>\r\n      </d-button>\r\n      <d-button type=\"primary\" v-if=\"showHostChart\" @click=\"goHostChart\" class=\"left mr10\">\r\n        主机监控\r\n        <icon name=\"bar-chart\" style=\"margin-left: 5px;\"/>\r\n      </d-button>\r\n    </div>\r\n    <my-table :data=\"tableData\" :showPin=\"showTablePin\" :page=\"page\" @on-size-change=\"handleSizeChange\"\r\n              @on-current-change=\"handleCurrentChange\" @on-view-detail=\"goDetail\" @on-scale=\"groupScale\"\r\n              @on-merge=\"groupMerge\" @on-del=\"del\" @on-addPartition=\"addPartition\" @on-removePartition=\"removePartition\" @on-position=\"goPosition\">\r\n    </my-table>\r\n\r\n    <!--详情-->\r\n    <my-dialog :dialog=\"groupDetailDialog\" @on-dialog-confirm=\"groupDetailConfirm()\" @on-dialog-cancel=\"groupDetailCancel()\">\r\n      <group-detail :data=\"groupDetailDialogData\"></group-detail>\r\n    </my-dialog>\r\n    <!--添加节点-->\r\n    <my-dialog :dialog=\"groupScaleDialog\" @on-dialog-confirm=\"groupScaleConfirm()\" @on-dialog-cancel=\"groupScaleCancel()\" >\r\n      <group-scale :data=\"groupScaleDialogData\"  ></group-scale>\r\n    </my-dialog>\r\n    <!--移除节点-->\r\n    <my-dialog :dialog=\"groupMergeDialog\" @on-dialog-confirm=\"groupMergeConfirm()\" @on-dialog-cancel=\"groupMergeCancel()\"  >\r\n      <group-merge :data=\"groupMergeDialogData\"  ></group-merge>\r\n    </my-dialog>\r\n    <!--主从同步-->\r\n    <my-dialog :dialog=\"positionDialog\" @on-dialog-confirm=\"positionConfirm()\" @on-dialog-cancel=\"positionCancel()\">\r\n      <group-position :data=\"positionDialogData\"></group-position>\r\n    </my-dialog>\r\n    <!--增加分区数-->\r\n    <my-dialog :dialog=\"addPartitionDialog\" @on-dialog-confirm=\"addPartitionConfirm()\" @on-dialog-cancel=\"addPartitionCancel()\"  >\r\n      <d-input v-model=\"addPartitionDialogData.partitionCount\" placeholder=\"请输入增加分区数\" style=\"width: 400px\">\r\n        <span slot=\"prepend\">增加分区数</span>\r\n      </d-input>\r\n    </my-dialog>\r\n    <!--减少分区数-->\r\n    <my-dialog :dialog=\"removePartitionDialog\" @on-dialog-confirm=\"removePartitionConfirm()\" @on-dialog-cancel=\"removePartitionCancel()\"  >\r\n      <d-input v-model=\"removePartitionDialogData.partitionCount\" placeholder=\"请输入减少分区数\" style=\"width: 400px\">\r\n        <span slot=\"prepend\">减少分区数</span>\r\n      </d-input>\r\n    </my-dialog>\r\n    <!--扩容-->\r\n    <my-dialog :dialog=\"groupNewDialog\" @on-dialog-confirm=\"groupNewConfirm()\" @on-dialog-cancel=\"groupNewCancel()\">\r\n      <group-new :data=\"groupNewDialogData\" @on-dialog-confirm=\"groupNewConfirm()\" @on-dialog-cancel=\"groupNewCancel()\"  @on-partition-group-change=\"topicUpdate\"></group-new>\r\n    </my-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport apiRequest from '../../utils/apiRequest.js'\r\nimport myTable from '../../components/common/myTable.vue'\r\nimport myDialog from '../../components/common/myDialog.vue'\r\nimport groupDetail from './groupDetail.vue'\r\nimport groupScale from './groupScale.vue'\r\nimport GroupPosition from './groupPosition.vue'\r\nimport groupMerge from './groupMerge.vue'\r\nimport groupNew from './groupNew.vue'\r\nimport crud from '../../mixins/crud.js'\r\nimport {getTopicCode} from '../../utils/common.js'\r\n\r\nexport default {\r\n  name: 'partitionGroup',\r\n  components: {\r\n    GroupPosition,\r\n    myTable,\r\n    myDialog,\r\n    groupDetail,\r\n    groupScale,\r\n    groupMerge,\r\n    groupNew\r\n  },\r\n  mixins: [ crud ],\r\n  props: {\r\n    showHostChart: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n    showBrokerChart: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      urls: {\r\n        search: `/partitionGroup/search`,\r\n        del: `/partitionGroup/delete`,\r\n        getBroker: `/broker/get`,\r\n        addPartition: `/partitionGroup/addPartition`,\r\n        removePartition: `/partitionGroup/removePartition`,\r\n        getMonitor: `/monitor`,\r\n        getUrl: `/grafana/getRedirectUrl`\r\n      },\r\n      searchData: {\r\n        topic: {\r\n          id: this.$route.query.id,\r\n          code: this.$route.query.code\r\n        },\r\n        namespace: {\r\n          id: this.$route.query.namespaceId,\r\n          code: this.$route.query.namespaceCode\r\n        },\r\n        keyword: ''\r\n      },\r\n      tableData: {\r\n        rowData: [],\r\n        colData: [\r\n          {\r\n            title: 'group',\r\n            width: '2%',\r\n            key: 'groupNo'\r\n          },\r\n          {\r\n            title: 'partitions',\r\n            width: '15%',\r\n            key: 'partitions'\r\n          },\r\n          {\r\n            title: '选举类型',\r\n            width: '5%',\r\n            key: 'electType',\r\n            render: (h, params) => {\r\n              let label\r\n              switch (params.item.electType) {\r\n                case 0:\r\n                  label = 'raft'\r\n                  break\r\n                case 1:\r\n                  label = 'fix'\r\n                  break\r\n              }\r\n              return h('label', {}, label)\r\n            }\r\n          },\r\n          {\r\n            title: '副本数',\r\n            width: '2%',\r\n            key: 'replicas'\r\n          },\r\n          {\r\n            title: '当前leader',\r\n            width: '15%',\r\n            key: 'ip',\r\n            formatter (item) {\r\n              return `${item.leader}:${item.ip}`\r\n            }\r\n          },\r\n          {\r\n            title: '推荐leader',\r\n            width: '10%',\r\n            key: 'recLeader'\r\n          },\r\n          {\r\n            title: 'isr',\r\n            key: 'isr'\r\n          },\r\n          {\r\n            title: 'term',\r\n            width: '2%',\r\n            key: 'term'\r\n          }\r\n        ],\r\n        btns: [\r\n          {\r\n            txt: '详情',\r\n            method: 'on-view-detail'\r\n          },\r\n          {\r\n            txt: '增加副本数',\r\n            method: 'on-scale'\r\n          },\r\n          {\r\n            txt: '减副本数',\r\n            method: 'on-merge'\r\n          },\r\n          {\r\n            txt: '删除',\r\n            method: 'on-del'\r\n          },\r\n          {\r\n            txt: '增加分区',\r\n            method: 'on-addPartition'\r\n          },\r\n          {\r\n            txt: '减少分区',\r\n            method: 'on-removePartition'\r\n          },\r\n          {\r\n            txt: '主从同步监控',\r\n            method: 'on-position'\r\n          }\r\n        ]\r\n      },\r\n      groupDetailDialog: {\r\n        visible: false,\r\n        title: '详情',\r\n        width: 800,\r\n        showFooter: false\r\n      },\r\n      groupDetailDialogData: {},\r\n      positionDialog: {\r\n        visible: false,\r\n        title: '主从同步监控',\r\n        width: 800,\r\n        showFooter: false\r\n      },\r\n      positionDialogData: {},\r\n      groupScaleDialog: {\r\n        visible: false,\r\n        title: '增加副本',\r\n        width: 800,\r\n        showFooter: false\r\n      },\r\n      groupScaleDialogData: {},\r\n      groupMergeDialog: {\r\n        visible: false,\r\n        title: '减少副本',\r\n        width: 800,\r\n        showFooter: false\r\n      },\r\n      groupMergeDialogData: {},\r\n      addPartitionDialog: {\r\n        visible: false,\r\n        title: '增加分区数',\r\n        width: 500,\r\n        showFooter: true\r\n      },\r\n      addPartitionDialogData: {},\r\n      removePartitionDialog: {\r\n        visible: false,\r\n        title: '减少分区数',\r\n        width: 800,\r\n        showFooter: true\r\n      },\r\n      removePartitionDialogData: {},\r\n      groupNewDialog: {\r\n        visible: false,\r\n        title: '详情',\r\n        width: 800,\r\n        showFooter: false\r\n      },\r\n      groupNewDialogData: {\r\n        topic: this.$route.query.topic,\r\n        namespace: this.$route.query.namespace,\r\n        electType: 0,\r\n        replicaGroups: [],\r\n        partitions: 0\r\n      },\r\n      newGroupData: {\r\n      }\r\n    }\r\n  },\r\n  computed: {\r\n  },\r\n  methods: {\r\n    // 查询\r\n    getList () {\r\n      this.showTablePin = true\r\n      let data = {\r\n        pagination: {\r\n          page: this.page.page,\r\n          size: this.page.size\r\n        },\r\n        query: {\r\n          topic: this.searchData.topic,\r\n          namespace: this.searchData.namespace,\r\n          keyword: this.searchData.keyword\r\n        }\r\n      }\r\n      apiRequest.post(this.urlOrigin.search, {}, data).then((data) => {\r\n        data.data = data.data || []\r\n        data.pagination = data.pagination || {\r\n          totalRecord: data.data.length\r\n        }\r\n        this.page.total = data.pagination.totalRecord\r\n        this.page.page = data.pagination.page\r\n        this.page.size = data.pagination.size\r\n        this.tableData.rowData = data.data\r\n        for (var i = 0; i < this.tableData.rowData.length; i++) {\r\n          this.getBroker(this.tableData.rowData, i)\r\n        }\r\n        this.showTablePin = false\r\n      })\r\n    },\r\n    getBroker (rowData, i) {\r\n      apiRequest.get(this.urlOrigin.getBroker + '/' + rowData[i].leader).then((data) => {\r\n        this.tableData.rowData[i].ip = data.data.ip\r\n        this.$set(this.tableData.rowData, i, this.tableData.rowData[i])\r\n      })\r\n    },\r\n    goBrokerChart () {\r\n      apiRequest.get(this.urls.getUrl + '/broker', {}, {}).then((data) => {\r\n        let url = data.data || ''\r\n        if (url.indexOf('?') < 0) {\r\n          url += '?'\r\n        } else if (!url.endsWith('?')) {\r\n          url += '&'\r\n        }\r\n        url = url + 'var-topic=' + getTopicCode(this.searchData.topic, this.searchData.namespace)\r\n        window.open(url)\r\n      })\r\n    },\r\n    goHostChart () {\r\n      apiRequest.get(this.urls.getUrl + '/host', {}, {}).then((data) => {\r\n        let url = data.data || ''\r\n        if (url.indexOf('?') < 0) {\r\n          url += '?'\r\n        } else if (!url.endsWith('?')) {\r\n          url += '&'\r\n        }\r\n        url = url + 'var-topic=' + getTopicCode(this.searchData.topic, this.searchData.namespace)\r\n        window.open(url)\r\n      })\r\n    },\r\n    goDetail (item) {\r\n      this.groupDetailDialogData = {groupNo: item.groupNo, topic: this.searchData.topic, namespace: this.searchData.namespace}\r\n      this.groupDetailDialog.visible = true\r\n    },\r\n    groupDetailConfirm () {\r\n\r\n    },\r\n    groupDetailCancel () {\r\n      this.groupDetailDialog.visible = false\r\n    },\r\n    goPosition (item) {\r\n      this.positionDialogData = {groupNo: item.groupNo, topic: this.searchData.topic, namespace: this.searchData.namespace}\r\n      this.positionDialog.visible = true\r\n    },\r\n    positionConfirm () {\r\n\r\n    },\r\n    positionCancel () {\r\n      this.positionDialog.visible = false\r\n    },\r\n    groupScale (item) {\r\n      this.groupScaleDialogData = {groupNo: item.groupNo, topic: {id: item.topic.id, code: item.topic.code}, namespace: {id: item.namespace.id, code: item.namespace.code}}\r\n      this.groupScaleDialog.visible = true\r\n    },\r\n    groupScaleConfirm () {\r\n\r\n    },\r\n    groupScaleCancel () {\r\n      this.groupScaleDialog.visible = false\r\n    },\r\n    groupNewConfirm () {\r\n\r\n    },\r\n    groupNewCancel () {\r\n      this.groupNewDialog.visible = false\r\n      this.getList()\r\n    },\r\n    groupNew () {\r\n      this.groupNewDialogData = {topic: this.searchData.topic, namespace: this.searchData.namespace}\r\n      this.groupNewDialog.visible = true\r\n    },\r\n    groupMerge (item) {\r\n      this.groupMergeDialog.visible = true\r\n      this.groupMergeDialogData = {groupNo: item.groupNo, topic: {id: item.topic.id, code: item.topic.code}, namespace: {id: item.namespace.id, code: item.namespace.code}}\r\n    },\r\n    groupMergeConfirm () {\r\n\r\n    },\r\n    groupMergeCancel () {\r\n      this.groupMergeDialog.visible = false\r\n      this.getList()\r\n    },\r\n    addPartition (item) {\r\n      this.addPartitionDialog.visible = true\r\n      this.addPartitionDialogData = item\r\n    },\r\n    addPartitionConfirm () {\r\n      if (this.addPartitionDialogData.partitionsCount <= 0) {\r\n        return\r\n      }\r\n      apiRequest.post(this.urls.addPartition, {}, this.addPartitionDialogData).then(() => {\r\n        this.addPartitionDialog.visible = false\r\n        this.getList()\r\n      })\r\n    },\r\n    addPartitionCancel () {\r\n      this.addPartitionDialog.visible = false\r\n    },\r\n    removePartition (item) {\r\n      this.removePartitionDialog.visible = true\r\n      this.removePartitionDialogData = item\r\n    },\r\n    removePartitionConfirm () {\r\n      if (this.removePartitionDialogData.partitionsCount <= 0) {\r\n        return\r\n      }\r\n      apiRequest.post(this.urls.removePartition, {}, this.removePartitionDialogData).then((data) => {\r\n        this.removePartitionDialog.visible = false\r\n        this.getList()\r\n      })\r\n    },\r\n    removePartitionCancel () {\r\n      this.removePartitionDialog.visible = false\r\n    },\r\n    del (item) {\r\n      var data = item\r\n      apiRequest.post(this.urls.del, {}, data).then(() => {\r\n        this.getList()\r\n      })\r\n    },\r\n    topicUpdate () {\r\n      this.$emit('on-partition-group-change')\r\n    },\r\n    afterDel () {\r\n      this.topicUpdate()\r\n    }\r\n  },\r\n  mounted () {\r\n    // this.getList();\r\n  }\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n  .label{text-align: right; line-height: 32px;}\r\n  .val{}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/topic/partitionGroup.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"ml20 mt30\"},[_c('d-button',{staticClass:\"left mr10\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.groupNew}},[_vm._v(\"\\n      扩容\\n      \"),_c('icon',{staticStyle:{\"margin-left\":\"5px\"},attrs:{\"name\":\"plus-circle\"}})],1),_vm._v(\" \"),_vm._t(\"extendBtns\"),_vm._v(\" \"),(_vm.showBrokerChart)?_c('d-button',{staticClass:\"left mr10\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.goBrokerChart}},[_vm._v(\"\\n      Broker监控\\n      \"),_c('icon',{staticStyle:{\"margin-left\":\"5px\"},attrs:{\"name\":\"bar-chart\"}})],1):_vm._e(),_vm._v(\" \"),(_vm.showHostChart)?_c('d-button',{staticClass:\"left mr10\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.goHostChart}},[_vm._v(\"\\n      主机监控\\n      \"),_c('icon',{staticStyle:{\"margin-left\":\"5px\"},attrs:{\"name\":\"bar-chart\"}})],1):_vm._e()],2),_vm._v(\" \"),_c('my-table',{attrs:{\"data\":_vm.tableData,\"showPin\":_vm.showTablePin,\"page\":_vm.page},on:{\"on-size-change\":_vm.handleSizeChange,\"on-current-change\":_vm.handleCurrentChange,\"on-view-detail\":_vm.goDetail,\"on-scale\":_vm.groupScale,\"on-merge\":_vm.groupMerge,\"on-del\":_vm.del,\"on-addPartition\":_vm.addPartition,\"on-removePartition\":_vm.removePartition,\"on-position\":_vm.goPosition}}),_vm._v(\" \"),_c('my-dialog',{attrs:{\"dialog\":_vm.groupDetailDialog},on:{\"on-dialog-confirm\":function($event){return _vm.groupDetailConfirm()},\"on-dialog-cancel\":function($event){return _vm.groupDetailCancel()}}},[_c('group-detail',{attrs:{\"data\":_vm.groupDetailDialogData}})],1),_vm._v(\" \"),_c('my-dialog',{attrs:{\"dialog\":_vm.groupScaleDialog},on:{\"on-dialog-confirm\":function($event){return _vm.groupScaleConfirm()},\"on-dialog-cancel\":function($event){return _vm.groupScaleCancel()}}},[_c('group-scale',{attrs:{\"data\":_vm.groupScaleDialogData}})],1),_vm._v(\" \"),_c('my-dialog',{attrs:{\"dialog\":_vm.groupMergeDialog},on:{\"on-dialog-confirm\":function($event){return _vm.groupMergeConfirm()},\"on-dialog-cancel\":function($event){return _vm.groupMergeCancel()}}},[_c('group-merge',{attrs:{\"data\":_vm.groupMergeDialogData}})],1),_vm._v(\" \"),_c('my-dialog',{attrs:{\"dialog\":_vm.positionDialog},on:{\"on-dialog-confirm\":function($event){return _vm.positionConfirm()},\"on-dialog-cancel\":function($event){return _vm.positionCancel()}}},[_c('group-position',{attrs:{\"data\":_vm.positionDialogData}})],1),_vm._v(\" \"),_c('my-dialog',{attrs:{\"dialog\":_vm.addPartitionDialog},on:{\"on-dialog-confirm\":function($event){return _vm.addPartitionConfirm()},\"on-dialog-cancel\":function($event){return _vm.addPartitionCancel()}}},[_c('d-input',{staticStyle:{\"width\":\"400px\"},attrs:{\"placeholder\":\"请输入增加分区数\"},model:{value:(_vm.addPartitionDialogData.partitionCount),callback:function ($$v) {_vm.$set(_vm.addPartitionDialogData, \"partitionCount\", $$v)},expression:\"addPartitionDialogData.partitionCount\"}},[_c('span',{attrs:{\"slot\":\"prepend\"},slot:\"prepend\"},[_vm._v(\"增加分区数\")])])],1),_vm._v(\" \"),_c('my-dialog',{attrs:{\"dialog\":_vm.removePartitionDialog},on:{\"on-dialog-confirm\":function($event){return _vm.removePartitionConfirm()},\"on-dialog-cancel\":function($event){return _vm.removePartitionCancel()}}},[_c('d-input',{staticStyle:{\"width\":\"400px\"},attrs:{\"placeholder\":\"请输入减少分区数\"},model:{value:(_vm.removePartitionDialogData.partitionCount),callback:function ($$v) {_vm.$set(_vm.removePartitionDialogData, \"partitionCount\", $$v)},expression:\"removePartitionDialogData.partitionCount\"}},[_c('span',{attrs:{\"slot\":\"prepend\"},slot:\"prepend\"},[_vm._v(\"减少分区数\")])])],1),_vm._v(\" \"),_c('my-dialog',{attrs:{\"dialog\":_vm.groupNewDialog},on:{\"on-dialog-confirm\":function($event){return _vm.groupNewConfirm()},\"on-dialog-cancel\":function($event){return _vm.groupNewCancel()}}},[_c('group-new',{attrs:{\"data\":_vm.groupNewDialogData},on:{\"on-dialog-confirm\":function($event){return _vm.groupNewConfirm()},\"on-dialog-cancel\":function($event){return _vm.groupNewCancel()},\"on-partition-group-change\":_vm.topicUpdate}})],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-a5a220e8\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/topic/partitionGroup.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-a5a220e8\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./partitionGroup.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./partitionGroup.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./partitionGroup.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-a5a220e8\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./partitionGroup.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-a5a220e8\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/topic/partitionGroup.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}