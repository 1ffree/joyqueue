{"version":3,"sources":["webpack:///src/views/setting/auditFlowForm.vue","webpack:///./src/views/setting/auditFlowForm.vue?17a6","webpack:///./src/views/setting/auditFlowForm.vue"],"names":["auditFlowForm","name","mixins","mixins_form","props","type","data","Object","default","id","manualExecute","applicantConfirm","executeClass","executeMethod","description","status","auditNodes","nodeNo","auditRoles","containAdmin","_this","this","formData","urls","rules","required","message","trigger","pattern","validator","rule","value","callback","trim","Error","max","auditRole","match","roles","split","i","length","toUpperCase","splice","push","join","error","methods","handlerManualExecuteChange","addAuditNode","removeAuditNode","index","handleAuditRolesChange","getFormData","assist","mounted","setting_auditFlowForm","render","_vm","_h","$createElement","_c","_self","ref","staticStyle","height","overflow-y","width","padding-right","attrs","model","label-width","label","prop","placeholder","$$v","$set","expression","_v","on","change","_e","rows","_l","auditNode","key","click","$event","preventDefault","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/34.0877c0f9aab72ac7c37a.js","sourcesContent":["<template>\n  <div>\n    <d-form ref=\"form\" :model=\"formData\" :rules=\"rules\" label-width=\"100px\"\n                style=\"height: 370px; overflow-y:auto; width: 100%; padding-right: 50px\">\n      <d-form-item label=\"类型:\" prop=\"type\">\n        <d-input v-model=\"formData.type\" placeholder=\"请输入用户类型，仅支持英文大写和-\"/>\n      </d-form-item>\n      <d-form-item label=\"用户确认:\" prop=\"applicantConfirm\">\n        <d-switch v-model=\"formData.applicantConfirm\"></d-switch>\n      </d-form-item>\n      <d-form-item label=\"手动执行:\" prop=\"manualExecute\" @change=\"handlerManualExecuteChange\">\n        <d-switch v-model=\"formData.manualExecute\"></d-switch>\n      </d-form-item>\n      <div v-if=\"formData.manualExecute\">\n        <d-form-item label=\"手动执行类:\" prop=\"executeClass\">\n          <d-input v-model=\"formData.executeClass\" placeholder=\"请输入手动执行调用的service，英文大小写格式\"/>\n        </d-form-item>\n        <d-form-item label=\"手动执行方法:\" prop=\"executeMethod\">\n          <d-input v-model=\"formData.executeMethod\" placeholder=\"请输入，默认为execute\"/>\n        </d-form-item>\n      </div>\n      <d-form-item label=\"备注:\" prop=\"description\" >\n        <d-input type=\"textarea\" rows=\"2\" v-model=\"formData.description\" placeholder=\"请输入备注\" />\n      </d-form-item>\n      <d-form-item\n        v-for=\"(auditNode, index) in formData.auditNodes\"\n        :label=\"'节点' + index\"\n        :key=\"auditNode.nodeNo\"\n        :error=\"error.auditNodes[index]\"\n        :required=\"true\"\n        :prop=\"'auditNodes.' + index\"\n        :rules=\"rules.auditNodes\"\n      >\n        <d-input type=\"textarea\" rows=\"2\" v-model=\"auditNode.auditRoles\"  @change=\"handleAuditRolesChange\"\n                     placeholder=\"请输入审批角色code,仅支持大小写字母，多个之间以英文逗号隔开\"/>\n        <span>授权管理员：</span><d-switch v-model=\"auditNode.containAdmin\"/>\n        <d-button @click.prevent=\"addAuditNode(auditNode)\">添加</d-button>\n        <d-button @click.prevent=\"removeAuditNode(auditNode)\">删除</d-button>\n      </d-form-item>\n    </d-form>\n  </div>\n</template>\n\n<script>\nimport form from '../../mixins/form.js'\nimport {deepCopy} from '../../utils/assist.js'\n\nexport default {\n  name: 'audit-flow-form',\n  mixins: [ form ],\n  props: {\n    type: 0, // add or edit form\n    data: {\n      type: Object,\n      default: function () {\n        return {\n          id: 0,\n          type: '',\n          manualExecute: true,\n          applicantConfirm: true,\n          executeClass: '',\n          executeMethod: '',\n          description: '',\n          status: 1,\n          auditNodes: [{\n            nodeNo: 0,\n            auditRoles: 'ADMIN',\n            containAdmin: true\n          }]\n        }\n      }\n    }\n  },\n  data () {\n    var executeClassValidator = (rule, value, callback) => {\n      if (this.formData.manualExecute) {\n        if (!this.formData.executeClass || !this.formData.executeClass.trim()) {\n          return callback(new Error('请输入手动执行类'))\n        } else {\n          this.formData.executeClass = this.formData.executeClass.trim()\n          return callback()\n        }\n      }\n      return callback()\n    }\n    var auditNodesValidator = (rule, value, callback) => {\n      let auditRole = value.auditRoles\n      // Validate whether auditRole\n      if (!auditRole || !auditRole.trim()) {\n        return callback(new Error('请输入审批角色Code，多个以英文逗号隔开'))\n      }\n      // Validate auditRole pattern\n      let reg = /^[a-zA-Z]{3,50}(,[a-zA-Z]{3,50})*$/\n      let result = auditRole.match(reg)\n      if (result == null) {\n        return callback(new Error('审批角色格式不匹配'))\n      }\n      // Format\n      let roles = auditRole.trim().split(',')\n      for (var i = 0; i < roles.length; i++) {\n        if (roles[i].toUpperCase() === 'ADMIN') {\n          roles.splice(i, 1)\n        }\n      }\n      if (value.containAdmin) {\n        roles.push('ADMIN')\n      }\n      value.auditRoles = roles.join(',')\n      return callback()\n    }\n    return {\n      formData: this.data || {},\n      urls: {\n        // getUserByIds: '/user/getByIds/',\n        // getUserByCode: '/user/getByCode/'\n      },\n      rules: {\n        type: [\n          {required: true, message: '请输入类型', trigger: 'change'},\n          {pattern: /^[A-Z]+[A-Z_]{1,60}[A-Z]+$/, message: '格式不匹配', trigger: 'change'}\n        ],\n        executeClass: [{validator: executeClassValidator, trigger: 'blur'}],\n        description: [{ max: 512, message: '长度在 512 个字符以内', trigger: 'blur' }],\n        auditNodes: [\n          // {required: true, message: '审批人不能为空', trigger: 'blur'},\n          // {pattern: /^[a-zA-Z]{3,50}(,[a-zA-Z]{3,50})*$/, message: '格式不匹配', trigger: 'change'},\n          {validator: auditNodesValidator, trigger: 'blur'}\n        ]\n      },\n      error: {\n        auditNodes: []\n      }\n    }\n  },\n  methods: {\n    handlerManualExecuteChange (data) {\n      if (!data) {\n        this.formData.executeClass = ''\n        this.formData.executeMethod = ''\n      }\n    },\n    addAuditNode () {\n      this.formData.auditNodes.push({\n        nodeNo: this.formData.auditNodes.length,\n        auditRoles: 'ADMIN',\n        containAdmin: true\n      })\n    },\n    removeAuditNode () {\n      var index = this.formData.auditNodes.nodeNo\n      if (index !== -1) {\n        this.formData.auditNodes.splice(index, 1)\n      }\n    },\n    handleAuditRolesChange (data) {\n      // todo\n    },\n    getFormData () {\n      for (var i = 0; i < this.formData.auditNodes.length; i++) {\n        var node = this.formData.auditNodes[i]\n        node.nodeNo = i\n      }\n      return deepCopy(this.formData || {})\n    }\n  },\n  mounted () {\n\n  }\n}\n</script>\n\n<style scoped>\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/setting/auditFlowForm.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('d-form',{ref:\"form\",staticStyle:{\"height\":\"370px\",\"overflow-y\":\"auto\",\"width\":\"100%\",\"padding-right\":\"50px\"},attrs:{\"model\":_vm.formData,\"rules\":_vm.rules,\"label-width\":\"100px\"}},[_c('d-form-item',{attrs:{\"label\":\"类型:\",\"prop\":\"type\"}},[_c('d-input',{attrs:{\"placeholder\":\"请输入用户类型，仅支持英文大写和-\"},model:{value:(_vm.formData.type),callback:function ($$v) {_vm.$set(_vm.formData, \"type\", $$v)},expression:\"formData.type\"}})],1),_vm._v(\" \"),_c('d-form-item',{attrs:{\"label\":\"用户确认:\",\"prop\":\"applicantConfirm\"}},[_c('d-switch',{model:{value:(_vm.formData.applicantConfirm),callback:function ($$v) {_vm.$set(_vm.formData, \"applicantConfirm\", $$v)},expression:\"formData.applicantConfirm\"}})],1),_vm._v(\" \"),_c('d-form-item',{attrs:{\"label\":\"手动执行:\",\"prop\":\"manualExecute\"},on:{\"change\":_vm.handlerManualExecuteChange}},[_c('d-switch',{model:{value:(_vm.formData.manualExecute),callback:function ($$v) {_vm.$set(_vm.formData, \"manualExecute\", $$v)},expression:\"formData.manualExecute\"}})],1),_vm._v(\" \"),(_vm.formData.manualExecute)?_c('div',[_c('d-form-item',{attrs:{\"label\":\"手动执行类:\",\"prop\":\"executeClass\"}},[_c('d-input',{attrs:{\"placeholder\":\"请输入手动执行调用的service，英文大小写格式\"},model:{value:(_vm.formData.executeClass),callback:function ($$v) {_vm.$set(_vm.formData, \"executeClass\", $$v)},expression:\"formData.executeClass\"}})],1),_vm._v(\" \"),_c('d-form-item',{attrs:{\"label\":\"手动执行方法:\",\"prop\":\"executeMethod\"}},[_c('d-input',{attrs:{\"placeholder\":\"请输入，默认为execute\"},model:{value:(_vm.formData.executeMethod),callback:function ($$v) {_vm.$set(_vm.formData, \"executeMethod\", $$v)},expression:\"formData.executeMethod\"}})],1)],1):_vm._e(),_vm._v(\" \"),_c('d-form-item',{attrs:{\"label\":\"备注:\",\"prop\":\"description\"}},[_c('d-input',{attrs:{\"type\":\"textarea\",\"rows\":\"2\",\"placeholder\":\"请输入备注\"},model:{value:(_vm.formData.description),callback:function ($$v) {_vm.$set(_vm.formData, \"description\", $$v)},expression:\"formData.description\"}})],1),_vm._v(\" \"),_vm._l((_vm.formData.auditNodes),function(auditNode,index){return _c('d-form-item',{key:auditNode.nodeNo,attrs:{\"label\":'节点' + index,\"error\":_vm.error.auditNodes[index],\"required\":true,\"prop\":'auditNodes.' + index,\"rules\":_vm.rules.auditNodes}},[_c('d-input',{attrs:{\"type\":\"textarea\",\"rows\":\"2\",\"placeholder\":\"请输入审批角色code,仅支持大小写字母，多个之间以英文逗号隔开\"},on:{\"change\":_vm.handleAuditRolesChange},model:{value:(auditNode.auditRoles),callback:function ($$v) {_vm.$set(auditNode, \"auditRoles\", $$v)},expression:\"auditNode.auditRoles\"}}),_vm._v(\" \"),_c('span',[_vm._v(\"授权管理员：\")]),_c('d-switch',{model:{value:(auditNode.containAdmin),callback:function ($$v) {_vm.$set(auditNode, \"containAdmin\", $$v)},expression:\"auditNode.containAdmin\"}}),_vm._v(\" \"),_c('d-button',{on:{\"click\":function($event){$event.preventDefault();return _vm.addAuditNode(auditNode)}}},[_vm._v(\"添加\")]),_vm._v(\" \"),_c('d-button',{on:{\"click\":function($event){$event.preventDefault();return _vm.removeAuditNode(auditNode)}}},[_vm._v(\"删除\")])],1)})],2)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-62b6fbef\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/setting/auditFlowForm.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-62b6fbef\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./auditFlowForm.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./auditFlowForm.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./auditFlowForm.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-62b6fbef\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./auditFlowForm.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-62b6fbef\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/setting/auditFlowForm.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}