webpackJsonp([46],{"2Hqc":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("IcnI"),n=a("95hR"),r=a("1a0f"),o=a("toiR"),i={name:"api-token",mixins:[n.a],props:{type:0,data:{type:Object,default:function(){return{code:s.a.getters.loginUserName,token:"",expireTime:null}}}},data:function(){return{formData:this.data,urls:{search:"/user/userToken",update:"/user/updateToken",invalid:"/user/invalidToken"},rules:{},months:"12"}},methods:{getList:function(){var t=this;r.a.get(this.urls.search+"/"+this.formData.code,{}).then(function(e){e.data=e.data||{},t.formData=e.data})},addMonth:function(t,e){e=parseInt(e);for(var a=t,s=a.getFullYear(),n=a.getMonth()+1+e,r=a.getDate();n>12;)s++,n-=12;for(var o=new Date(s,n-1,r);o.getMonth()!=n-1;)r--,o=new Date(s,n-1,r);return o},timestampToStr:function(t){return Object(o.b)(t)},invalidToken:function(){var t=this;r.a.put(this.urls.invalid+"/"+this.formData.code,{}).then(function(e){e.data=e.data||{},"success"===e.data?(t.$Message.success("更新成功"),t.getList()):t.$Message.error("更新失败")})},updateToken:function(){var t=this,e=parseInt(this.months),a=new Date,n=(a=this.addMonth(a,e)).getTime(),o={code:s.a.getters.loginUserName,expireTime:n};r.a.postBase(this.urls.update,{},o,!1).then(function(e){e.data=e.data||{},"success"===e.data?(t.$Message.success("更新成功"),t.getList()):t.$Message.error("更新失败")})}},mounted:function(){this.getList()}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"ml20 mt30"},[a("d-form",{ref:"form",attrs:{model:t.formData,rules:t.rules,"label-width":"100px"}},[a("d-form-item",{attrs:{label:"用户名："}},[a("grid-col",{staticClass:"label",attrs:{span:2}},[a("span",[t._v(t._s(t.formData.code))])])],1),t._v(" "),null!=t.formData.token?a("d-form-item",{attrs:{label:"令牌:"}},[a("span",[t._v(t._s(t.formData.token))])]):t._e(),t._v(" "),null!=t.formData.token?a("d-form-item",{attrs:{label:"有效期限:"}},[a("span",[t._v(t._s(t.timestampToStr(t.formData.expireTime,!1,!1)))])]):t._e(),t._v(" "),a("d-form-item",{attrs:{label:"有效期:"}},[t.$store.getters.isAdmin?a("d-select",{staticClass:"left",staticStyle:{width:"200px"},attrs:{placeholder:"请选择有效期"},model:{value:t.months,callback:function(e){t.months=e},expression:"months"}},[a("d-option",{attrs:{value:"6"}},[t._v("六个月")]),t._v(" "),a("d-option",{attrs:{value:"12"}},[t._v("十二个月")]),t._v(" "),a("d-option",{attrs:{value:"36"}},[t._v("三年")])],1):t._e()],1),t._v(" "),a("div",{staticClass:"ml20 mt30",staticStyle:{"margin-top":"20px","margin-left":"20px"}},[a("d-button",{staticClass:"left mr10",on:{click:function(e){return t.invalidToken()}}},[t._v("过期")]),t._v(" "),a("d-button",{staticClass:"left mr10",attrs:{type:"primary"},on:{click:function(e){return t.updateToken()}}},[t._v("更新")])],1)],1)],1)])},staticRenderFns:[]};var u=a("VU/8")(i,l,!1,function(t){a("PEPC")},"data-v-3ef3e382",null);e.default=u.exports},PEPC:function(t,e){}});
//# sourceMappingURL=46.ffd10cacc4c332b761f3.js.map